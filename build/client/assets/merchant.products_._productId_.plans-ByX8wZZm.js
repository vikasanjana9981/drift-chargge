import{j as e,r as t}from"./index-DngLVFUg.js";import{f as be,u as Ne}from"./shopifyIdUtils-PhKRAdsZ.js";import{b as A,p as oe,C as z}from"./ConfirmationModal-2v7BHoQs.js";import{u as R,k as T}from"./index-xIj4AxVg.js";import{d as J,c as Y,O as xe,_ as ee,s as D,t as F,p as de,a as M,b as ne,e as Ce,f as re}from"./plansAtom-BDG5N9ri.js";import{d as K,G as Se,t as E}from"./index-CZBhWrIY.js";import{i as he,j as fe,k as Te,c as ge}from"./index-hoEkgPmj.js";import{c as ye,d as ce,s as we,i as De}from"./shopAtom-DHlAgFdS.js";import{l as O,f as Ae}from"./flex-CRP9ZW6z.js";import{N as V,P as X,i as pe,u as W,p as Z,a as se,b as B,m as L,y as le,e as je}from"./SellingPlanFormUtils-D_WkLg4x.js";import"./datepicker-Bhj_Xp2q.js";import{m as Ee}from"./messages-BV2XNudo.js";import{o as _,q as Ie,r as Re}from"./components-DCDtNDXQ.js";import"./modal-bge_ITEm.js";const Pe=({isPlanEnabled:s,onToggle:l})=>e.jsxs(K.Flex,{align:"center",justify:"between",children:[e.jsx(K.Flex,{align:"center",gap:"2",children:e.jsx(K.Title,{as:"h3",className:"text-sm",children:"One-time plan settings"})}),e.jsx(K.Switch,{checked:s,onChange:()=>l(!s)})]});function ue(s){return Se({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M225.814 32.316c-3.955-.014-7.922-.01-11.9.007-19.147.089-38.6.592-58.219 1.32l5.676 24.893c20.431-2.31 42.83-4.03 65.227-4.89 12.134-.466 24.194-.712 35.892-.65 35.095.183 66.937 3.13 87.77 11.202l8.908 3.454-3.977 8.685c-29.061 63.485-35.782 124.732-31.228 184.826 2.248-71.318 31.893-134.75 70.81-216.068-52.956-8.8-109.634-12.582-168.959-12.78zm28.034 38.79c-8.74.007-17.65.184-26.559.526-41.672 1.6-83.199 6.49-110.264 12.096 30.233 56.079 54.69 112.287 70.483 167.082a71.934 71.934 0 0 1 5.894.045c4.018.197 7.992.742 11.875 1.59-16.075-51.397-34.385-98.8-57.146-146.131l-5.143-10.694 11.686-2.068c29.356-5.198 59.656-7.21 88.494-7.219 1.922 0 3.84.007 5.748.024 18.324.16 35.984 1.108 52.346 2.535l11.054.965-3.224 10.617c-18.7 61.563-22.363 127.678-11.79 190.582.176.163.354.325.526.49 3.813-1.336 7.38-2.698 10.705-4.154-8.254-67.394-4.597-136.923 26.229-209.201-17.202-4.383-43.425-6.674-72.239-7.034a656.656 656.656 0 0 0-8.675-.05zm144.945 7.385c-30.956 65.556-52.943 118.09-56.547 174.803 20.038-66.802 58.769-126.685 102.904-165.158a602.328 602.328 0 0 0-46.357-9.645zM103.832 97.02c-18.76 3.868-37.086 8.778-54.812 15.562 8.626 7.48 24.22 21.395 43.14 39.889 8.708-8.963 17.589-17.818 26.852-25.87a1067.587 1067.587 0 0 0-15.18-29.581zm142.023 7.482c-13.62-.066-27.562.324-41.554 1.293-1.468 13.682-9.56 26.482-19.225 39.07 15.431 36.469 28.758 73.683 40.756 113.194 18.375 5.42 36.554 11.827 51.28 19.504-5.47-42.458-4.722-85.963 2.38-128.508-12.885-13.31-19.597-28.09-20.135-44.34a621.48 621.48 0 0 0-13.502-.213zm182.018 26.985c-24.73 29.3-46.521 65.997-61.37 105.912 27.264-38.782 60.79-69.032 96.477-90.4a1318.664 1318.664 0 0 0-35.107-15.512zm-300.74 11.959c-14.594 13.188-29.014 29.017-44.031 44.097 32.289 19.191 59.791 41.918 82.226 67.66 1.393-.526 2.8-.999 4.215-1.43-10.498-36.096-24.885-73.033-42.41-110.327zM360.52 268.198c-16.397 19.788-31.834 30.235-53.09 38.57 2.391 9.22-1.16 19.805-9.334 27.901-4.808 4.761-10.85 10.188-19.684 13.715a62.896 62.896 0 0 0 3.9 2.127c12.364 6.17 34.207 4.18 54.5-5.049 20.23-9.2 38.302-25.092 45-41.191 3.357-9.05.96-13.77-4.917-20.692-4.184-4.925-10.295-9.89-16.375-15.38zm-170.079.586c-10.715-.098-21.597 2.994-30.59 9.76-12.79 9.623-22.65 26.784-22.738 55.934v.2l-.01.2c-2.92 61.381 1.6 89.7 10.555 105.065 7.904 13.562 21.05 20.054 40.28 31.994.916-2.406 1.87-5.365 2.765-9.098 2.277-9.499 4.161-22.545 5.355-36.975 2.389-28.858 2.04-63.51-1.955-88.445l-2.111-13.19 13.016 2.995c31.615 7.273 49.7 8.132 60.2 6.28 10.502-1.854 14.061-5.523 20.221-11.624 5.79-5.732 5.682-7.795 4.456-11.021-1.227-3.227-6.149-8.545-14.5-13.633-16.703-10.176-45.085-19.611-71.614-26.647a53.988 53.988 0 0 0-13.33-1.795zm189.1 69.416c-10.013 9.754-22.335 17.761-35.277 23.647-20.983 9.542-44.063 13.907-63.211 7.553-6.76 2.516-10.687 5.407-12.668 7.8-2.718 3.284-2.888 5.7-1.967 9.16.92 3.46 3.665 7.568 7.059 10.524 3.393 2.956 7.426 4.492 8.959 4.564 46.794 2.222 67.046-11.207 92.277-26.783 7.358-4.542 10.174-13.743 9.469-22.931-.353-4.594-1.69-8.911-3.233-11.63a9.009 9.009 0 0 0-1.408-1.904zm-166.187 9.096c2.727 25.068 2.772 54.314.642 80.053-1.247 15.072-3.175 28.779-5.789 39.685-1.137 4.746-2.388 8.954-3.9 12.659l146.697-6.465c-1.656-6.149-3.344-12.324-5.031-18.502a127.004 127.004 0 0 1-17.24 4.424l.044.73-8.316.518c-5.121.614-10.452.953-15.983.992l-83.86 5.21 2.493-11.607c7.947-37.006 8.68-69.589 3.778-105.234a353.433 353.433 0 0 1-13.536-2.463zm31.972 4.684c3.948 31.933 3.473 62.41-2.406 95.2l19.264-1.196a39.44 39.44 0 0 1-6.1-14.778c-1.296-6.88-.575-14.538 3.926-20.87.199-.281.414-.55.627-.821-5.246-4.845-9.628-11.062-11.614-18.524-2.114-7.944-.794-17.67 5.497-25.27 2.079-2.51 4.592-4.776 7.543-6.816-2.61-2.08-4.898-4.285-6.874-6.582-3.064.021-6.345-.093-9.863-.343zm132.666 41.785c-23.456 14.253-49.81 27.876-96.41 25.664a26.402 26.402 0 0 1-4.518-.615c-1.233.553-1.891 1.256-2.382 1.947-.963 1.355-1.532 3.8-.909 7.113 1.248 6.627 7.525 13.889 13.37 14.569 41.385 4.813 69.979-8.726 87.341-24.477 8-7.258 8.068-11.9 6.89-16.951-.59-2.523-1.89-4.969-3.382-7.25zm-6.683 49.062a114.657 114.657 0 0 1-8.547 4.86c1.65 6.051 3.304 12.102 4.937 18.154l19.92-3.572c-5.14-4.387-9.162-8.954-12.39-13.496-1.442-2.029-2.713-4.001-3.92-5.946z"},child:[]}]})(s)}const ve=({plan:s,index:l,actions:a})=>e.jsxs("div",{className:"p-5 border rounded-lg shadow-md bg-white flex flex-col gap-3 transition-all hover:shadow-lg w-full",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"text-green-600 text-xl"}),e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:s.planName||"Unnamed Plan"})]})}),e.jsx("div",{className:"flex justify-between items-center text-sm text-gray-700",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("p",{children:[e.jsx(ye,{className:"inline-block text-blue-500 mr-1"}),e.jsx("strong",{children:"Plan Type:"})," One-time Purchase"]}),s.pricingPolicyAdjustmentValue&&e.jsxs("p",{className:"text-green-600 font-medium",children:[e.jsx(ce,{className:"inline-block text-yellow-500 mr-1"}),e.jsx("strong",{children:"Discount:"})," ",s.pricingPolicyAdjustmentValue,"%"]})]})}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsxs(A.Button,{variant:"outline",size:"sm",onClick:()=>a.onEdit(l),children:[e.jsx(he,{className:"mr-1 text-blue-500"})," Edit"]}),e.jsxs(A.Button,{variant:"outline",size:"sm",color:"danger",onClick:()=>a.onDelete(l),children:[e.jsx(fe,{className:"mr-1 text-red-500"})," Delete"]})]})]}),Ge=()=>{const[s,l]=t.useState(J),[a,o]=t.useState(!1),[u,f]=t.useState(!1),[p,m]=t.useState(!1),[c]=R(oe),[d,v]=R(Y);t.useEffect(()=>{c&&(J.planName=c.title)},[c]),t.useEffect(()=>{var n;if((n=d==null?void 0:d.oneTimeGroup)!=null&&n.groupId){const C=d.oneTimeGroup.sellingPlansToCreate[0];l(C),o(!0),m(!0)}},[]);const r=t.useCallback((n,C)=>{l(N=>({...N,[n]:C})),m(!0)},[]),h=async()=>{f(!0);try{T.success("One-time plan saved successfully!"),o(!0),m(!1),v(n=>({...n,oneTimeGroup:{groupName:s.planName,sellingPlansToCreate:[s]}}))}finally{f(!1)}},j=t.useCallback(n=>{o(n),m(n)},[]),b=t.useCallback(()=>{m(!0)},[]),g=t.useCallback(()=>{o(!1),m(!1),l(J),T.success("Plan deleted successfully!")},[]);return t.useEffect(()=>{p&&setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},100)},[p]),e.jsxs("div",{className:"border border-muted rounded-[10px] p-3 relative",children:[u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})}),e.jsx(Pe,{isPlanEnabled:a,onToggle:j}),a&&(p?e.jsx(xe,{currentPlan:s,onChange:r,onSave:h,productTitle:(c==null?void 0:c.title)||""}):e.jsx("div",{className:"mt-6",children:e.jsx(ve,{plan:s,index:0,actions:{onEdit:b,onDelete:g,onDuplicate:()=>{}}})}))]})},ae=({plan:s,index:l,actions:a,prePaidFrom:o})=>{const{billingRecurringPolicyInterval:u,billingRecurringPolicyIntervalCount:f,pricingPolicyEnable:p,pricingPolicyAdjustmentValue:m,pricingPolicyAfterCycleAdjustmentType:c,planName:d,deliveryRecurringPolicyIntervalCount:v,deliveryRecurringPolicyInterval:r,pricingPolicyAdjustmentType:h}=s,[j]=R(we),{currencyFormats:{moneyWithCurrencyFormat:b}}=j,g=t.useMemo(()=>h==="FIXED_AMOUNT"||h==="PRICE"?be(m,b):null,[m,h,b]);return e.jsxs("div",{className:"p-5 border rounded-lg shadow-md bg-white flex flex-col gap-3 transition-all hover:shadow-lg w-full",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"text-green-600 text-xl"}),e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:d||"Unnamed Plan"})]})}),e.jsx("div",{className:"flex justify-between items-center text-sm text-gray-700",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"capitalize flex items-center",children:[e.jsx(ye,{className:"inline-block text-blue-500 mr-2"}),e.jsx("strong",{children:"Frequency:"}),e.jsxs(E.Text,{className:"capitalize ms-2",children:[f," ",u]})]}),o&&e.jsxs("div",{className:"capitalize flex items-center",children:[e.jsx(De,{className:"inline-block text-blue-500 mr-2"}),e.jsx("strong",{children:"Delivery Every:"}),e.jsxs(E.Text,{className:"capitalize ms-2",children:[v," ",r]})]}),p&&e.jsxs(e.Fragment,{children:[h==="PERCENTAGE"&&e.jsxs("p",{className:"text-green-600 font-medium flex items-center",children:[e.jsx(ce,{className:"inline-block text-yellow-500 mr-2"}),e.jsx("strong",{children:"Discount:"})," ",m,"%"]}),g&&e.jsxs("div",{className:"text-green-600 font-medium flex items-center",children:[e.jsx(ce,{className:"inline-block text-yellow-500 mr-2"}),e.jsx("strong",{children:h==="FIXED_AMOUNT"||h==="PERCENTAGE"?"Discount:":"Price:"}),e.jsx(E.Text,{className:"capitaliz",children:g})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsxs(A.Button,{variant:"outline",size:"sm",onClick:()=>a.onEdit(l),children:[e.jsx(he,{className:"mr-1 text-blue-500"})," Edit"]}),e.jsxs(A.Button,{variant:"outline",size:"sm",onClick:()=>a.onDuplicate(l),children:[e.jsx(Te,{className:"mr-1 text-green-500"})," Duplicate"]}),e.jsxs(A.Button,{variant:"outline",size:"sm",color:"danger",onClick:()=>a.onDelete(l),children:[e.jsx(fe,{className:"mr-1 text-red-500"})," Delete"]})]})]})},Fe=({handleChange:s,plan:l})=>{const{pricingPolicyEnable:a,pricingPolicyAdjustmentValue:o,pricingPolicyAdjustmentType:u,pricingPolicyAfterCycleEnable:f,pricingPolicyAfterCycle:p,pricingPolicyAfterCycleAdjustmentValue:m,pricingPolicyAfterCycleAdjustmentType:c}=l;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee.Switch,{checked:a,onChange:()=>s("pricingPolicyEnable",!a),label:"Offer a discount on this frequency"}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(V,{label:"Discount Value",value:o,onChange:d=>s("pricingPolicyAdjustmentValue",d)})}),e.jsx("div",{className:"flex-1",children:e.jsx(D.Select,{value:X.find(d=>d.value===u),options:X,onChange:d=>d&&s("pricingPolicyAdjustmentType",d.value),label:"Discount Type"})})]}),e.jsx(ee.Switch,{checked:f,onChange:()=>s("pricingPolicyAfterCycleEnable",!f),label:"Change discount after specific number of payments"}),f&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(V,{label:"Change After Charges",value:p,onChange:d=>s("pricingPolicyAfterCycle",d)}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(V,{label:"New Discount Value",value:m,onChange:d=>s("pricingPolicyAfterCycleAdjustmentValue",d)})}),e.jsx("div",{className:"flex-1",children:e.jsx(D.Select,{value:X.find(d=>d.value===c),options:X,onChange:d=>d&&s("pricingPolicyAfterCycleAdjustmentType",d.value),label:"New Discount Type"})})]})]})]})]})},Oe=({handleChange:s,plan:l})=>{const{inventoryPolicyEnable:a,inventoryPolicyReserve:o}=l;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee.Switch,{checked:a,onChange:()=>s("inventoryPolicyEnable",!a),label:"Set Inventory Policy"}),a&&e.jsx(D.Select,{value:pe.find(u=>u.value===o),options:pe,onChange:u=>u&&s("inventoryPolicyReserve",u.value),label:"When to reserve inventory for the order."})]})},Ue=(s,l)=>{switch(s){case"DAY":return l;case"WEEK":return l*7;case"MONTH":return l*30;case"YEAR":return l*365;default:return 0}},ke=(s,l)=>{if(!l)return 0;const a={DAY:1,WEEK:7,MONTH:30,YEAR:365}[l]||1;return Math.floor((s-1)/a)},Me=s=>[],Q={getDays:Ue,getMaxDeliveryCount:ke,validatePlanBeforeApiCall:Me},Be=({currentPlan:s,onChange:l,prePaidFrom:a=!1})=>{const{deliveryRecurringPolicyAnchorsCutoffDay:o,deliveryRecurringPolicyAnchorsDay:u,deliveryRecurringPolicyAnchorsMonth:f,deliveryRecurringPolicyAnchorsType:p,deliveryRecurringPolicyCutoff:m,deliveryRecurringPolicyInterval:c,deliveryRecurringPolicyIntervalCount:d,billingRecurringPolicyInterval:v,billingRecurringPolicyIntervalCount:r,deliveryRecurringPreAnchorBehavior:h}=s,j=Q.getDays(v,r||1),b=Q.getDays(c,d||0);W.map(n=>({...n,disabled:Q.getMaxDeliveryCount(j,n.value)<1}));const g=Q.getMaxDeliveryCount(j,c);return e.jsxs("div",{className:"pt-3",children:[a&&e.jsxs("div",{className:"flex w-full gap-4 mb-3 flex-wrap",children:[e.jsx("div",{className:"w-[48%]",children:e.jsx(V,{label:"Delivery Frequency",value:d??0,onChange:n=>l("deliveryRecurringPolicyIntervalCount",n),min:1,max:g})}),e.jsx("div",{className:"w-[48%]",children:e.jsx(D.Select,{value:W.find(n=>n.value===c),options:W,onChange:n=>{n&&l("deliveryRecurringPolicyInterval",n.value)},label:"Unit"})}),b>=j&&e.jsx(E.Text,{className:"text-red-500 mt-2 w-[100%]",children:"Delivery interval must be shorter than the billing interval"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(D.Select,{value:Z.find(n=>n.value===h),options:Z,onChange:n=>n&&l("deliveryRecurringPreAnchorBehavior",n.value),label:"The pre-anchor behavior."})}),e.jsxs("div",{className:"flex flex-col gap-4 mt-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(D.Select,{value:se.find(n=>n.value===p),options:se,onChange:n=>n&&l("deliveryRecurringPolicyAnchorsType",n.value),label:"When Should Delivery Be Scheduled?"})}),p=="WEEKDAY"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"",children:e.jsx(D.Select,{value:B.find(n=>n.value===u),options:B,onChange:n=>n&&l("deliveryRecurringPolicyAnchorsDay",n.value),label:"Select Day"})}),e.jsx("div",{className:"",children:e.jsx(D.Select,{value:B.find(n=>n.value===o),options:B,onChange:n=>n&&l("deliveryRecurringPolicyAnchorsCutoffDay",n.value),label:"Cutfoff Time Interval"})})]}),p==="MONTHDAY"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(D.Select,{value:L.find(n=>n.value===f),options:L,onChange:n=>n&&l("deliveryRecurringPolicyAnchorsMonth",n.value),label:"Select Month"})}),e.jsx("div",{children:e.jsx(D.Select,{value:L.find(n=>n.value===o),options:L,onChange:n=>n&&l("deliveryRecurringPolicyAnchorsCutoffDay",n.value),label:"Cutfoff Time Interval"})})]}),p=="YEARDAY"&&e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(D.Select,{value:le.find(n=>n.value===u),options:le,onChange:n=>n&&l("deliveryRecurringPolicyAnchorsDay",n.value),label:"Select Day"})}),e.jsx("div",{className:"flex flex-col gap-4 mt-3",children:e.jsx("div",{className:"flex-1",children:e.jsx(D.Select,{value:Z.find(n=>n.value===h),options:Z,onChange:n=>n&&l("deliveryRecurringPreAnchorBehavior",n.value),label:"The pre-anchor behavior."})})})]})]})},Le=({handleChange:s,plan:l,prePaidFrom:a=!1})=>e.jsx("div",{className:"",children:e.jsx(Be,{currentPlan:l,onChange:s,prePaidFrom:a})}),ze=({currentPlan:s,onChange:l})=>{const{billingRecurringPolicyEnable:a,billingRecurringPolicyInterval:o,billingRecurringPolicyIntervalCount:u,billingRecurringPolicyMinCycles:f,billingRecurringPolicyMaxCycles:p,billingRecurringPolicyAnchorsType:m,billingRecurringPolicyAnchorsDay:c,billingRecurringPolicyAnchorsCutoffDay:d,billingRecurringPolicyAnchorsMonth:v}=s;return t.useEffect(()=>{const r=`${u} ${o.toLowerCase()} Subscription`;l("planName",r)},[u,o]),e.jsx("div",{className:"pt-3 border-t-2",children:e.jsxs("div",{className:"flex gap-4 mt-3 flex-wrap",children:[e.jsxs("div",{className:"flex w-full gap-4",children:[e.jsx("div",{className:"w-[50%]",children:e.jsx(V,{label:"Billing Frequency",value:u,onChange:r=>l("billingRecurringPolicyIntervalCount",r)})}),e.jsx("div",{className:"w-[50%]",children:e.jsx(D.Select,{value:W.find(r=>r.value===o),options:W,onChange:r=>{r&&l("billingRecurringPolicyInterval",r.value)},label:"Unit"})})]}),e.jsxs("div",{className:"flex w-full gap-4",children:[e.jsx("div",{className:"flex-1 w-[50%]",children:e.jsx(V,{label:"Billing Policy Min Cycles",value:f??0,onChange:r=>l("billingRecurringPolicyMinCycles",r)})}),e.jsx("div",{className:"flex-1 w-[50%]",children:e.jsx(V,{label:"Billing Policy Max Cycles",value:p??0,onChange:r=>l("billingRecurringPolicyMaxCycles",r)})})]}),e.jsxs("div",{className:"flex flex-col gap-4 mt-3 w-full",children:[e.jsx("div",{className:"flex-1",children:e.jsx(D.Select,{value:se.find(r=>r.value===m),options:se,onChange:r=>r&&l("billingRecurringPolicyAnchorsType",r.value),label:"When Should Delivery Be Scheduled?"})}),m=="WEEKDAY"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"",children:e.jsx(D.Select,{value:B.find(r=>r.value===c),options:B,onChange:r=>r&&l("billingRecurringPolicyAnchorsDay",r.value),label:"Select Day"})}),e.jsx("div",{className:"",children:e.jsx(D.Select,{value:B.find(r=>r.value===d),options:B,onChange:r=>r&&l("billingRecurringPolicyAnchorsCutoffDay",r.value),label:"Cutfoff Time Interval"})})]}),m==="MONTHDAY"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(D.Select,{value:L.find(r=>r.value===v),options:L,onChange:r=>r&&l("deliveryRecurringPolicyAnchorsMonth",r.value),label:"Select Month"})}),e.jsx("div",{children:e.jsx(D.Select,{value:L.find(r=>r.value===d),options:L,onChange:r=>r&&l("billingRecurringPolicyAnchorsCutoffDay",r.value),label:"Cutfoff Time Interval"})})]}),m=="YEARDAY"&&e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(D.Select,{value:le.find(r=>r.value===c),options:le,onChange:r=>r&&l("billingRecurringPolicyAnchorsDay",r.value),label:"Select Day"})})]})]})})},qe=({handleChange:s,plan:l})=>e.jsx("div",{children:e.jsx(ze,{currentPlan:l,onChange:s})}),$e=({handleChange:s,plan:l,prePaidFrom:a})=>{const{billingRecurringPolicyInterval:o,billingRecurringPolicyIntervalCount:u,pricingPolicyEnable:f,pricingPolicyAdjustmentValue:p,pricingPolicyAfterCycleAdjustmentType:m,planName:c,showDescription:d,descriptionContent:v}=l,[r,h]=t.useState(l.planName||""),[j,b]=t.useState(!1),g=t.useRef(j);t.useEffect(()=>{g.current=j},[j]),t.useEffect(()=>{h(l.planName||""),b(!1),g.current=!1},[l]),t.useEffect(()=>{if(!g.current){const C=`${u} ${o.toLowerCase()} Subscription`;r!==C&&(h(C),s("planName",C))}},[u,o]);const n=C=>{const N=C.target.value;h(N),s("planName",N),g.current||(b(!0),g.current=!0)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Plan Name"}),e.jsx(je.Input,{type:"text",value:r,onChange:n,className:"w-full p-2"})]}),e.jsx(ee.Switch,{checked:d,onChange:()=>s("showDescription",!d),label:"Show Description"}),d&&e.jsx(e.Fragment,{})]})})},me=[{label:"Pricing Policy",value:"pricing-policy",content:(s,l,a=!1)=>e.jsx(Fe,{plan:s,handleChange:l})},{label:"Inventory Policy",value:"inventory-policy",content:(s,l,a=!1)=>e.jsx(Oe,{plan:s,handleChange:l})},{label:"Billing Policy",value:"billing-policy",content:(s,l,a=!1)=>e.jsx(qe,{plan:s,handleChange:l})},{label:"Delivery Policy",value:"delivery-policy",content:(s,l,a=!1)=>e.jsx(Le,{plan:s,handleChange:l,prePaidFrom:a})},{label:"Display Contents",value:"display",content:(s,l,a=!1)=>e.jsx($e,{prePaidFrom:a,plan:s,handleChange:l})}],te=({plan:s,onChange:l,prePaidFrom:a})=>{const o=(u,f)=>{l({...s,[u]:f})};return e.jsxs(F.Tab,{vertical:!0,className:"w-full",children:[e.jsx(F.Tab.List,{className:"w-[28%]",children:me.map(u=>e.jsx(F.Tab.ListItem,{children:u.label},u.value))}),e.jsx(F.Tab.Panels,{className:"w-full",children:me.map(u=>e.jsx(F.Tab.Panel,{children:u.content(s,o,a)},u.value))})]})};function He({title:s,className:l,description:a,children:o}){return e.jsxs("div",{className:ge("grid gap-5 3xl:grid-cols-12",l),children:[s&&e.jsxs("div",{className:"col-span-full 4xl:col-span-4",children:[e.jsx("h4",{className:"text-base font-medium",children:s}),a&&e.jsx("p",{className:"mt-2",children:a})]}),o&&e.jsx("div",{className:"col-span-full grid gap-4 2xl:grid-cols-2 4xl:col-span-8 4xl:gap-5 xl:gap-7",children:o})]})}function ie({onChange:s,currentGroup:l}){const a=Ee.products.createSellingPlans.basicInfo;return e.jsx("div",{className:"border border-muted rounded-[10px] p-3",children:e.jsx(He,{title:"Basic Info",description:"",className:ge(""),children:e.jsxs("div",{children:[e.jsx(je.Input,{label:a.title,placeholder:a.inputs.planName.placeHolder,value:l.groupName,onChange:o=>s("groupName",o.target.value)}),e.jsx(E.Text,{as:"p",className:"text-sm text-gray-500",children:a.description})]})})})}const q=(s,l,a)=>{const[o,u]=t.useState(null);return t.useCallback((...f)=>{a(!0),o&&clearTimeout(o);const p=setTimeout(()=>{s(...f),a(!1)},l);u(p)},[s,l,a])},Ve=()=>{const[s,l]=R(de),[a,o]=R(Y),[u,f]=t.useState(null),[p,m]=t.useState(null),[c,d]=t.useState(M),[v,r]=t.useState(ne),[h,j]=t.useState(!1),[b,g]=t.useState(!1),[n,C]=t.useState(!1),[N,w]=t.useState(!1),[$]=_(),I=$.get("plansUpdate")==="yes",H=t.useRef(null),G=q(l,50,w);t.useEffect(()=>{console.log("createPlanPageState",a),I&&(a!=null&&a.payPerShipmentGroup)&&(r({groupName:a.payPerShipmentGroup.groupName,sellingPlansToUpdate:a.payPerShipmentGroup.sellingPlansToUpdate,descriptionContent:a.payPerShipmentGroup.descriptionContent,sellingPlansToCreate:[]}),a.payPerShipmentGroup.sellingPlansToUpdate&&l(a.payPerShipmentGroup.sellingPlansToUpdate))},[I,a==null?void 0:a.payPerShipmentGroup]);const U=()=>{if(u!==null){const i=[...s];i[u]=c,G(i),o(x=>({...x,payPerShipmentGroup:{...x==null?void 0:x.payPerShipmentGroup,sellingPlansToUpdate:i}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan updated"}))}else{if(s.some(P=>P.orderFrequency===c.billingRecurringPolicyIntervalCount&&P.frequencyUnit===c.billingRecurringPolicyInterval)){T.error(e.jsx(E.Text,{as:"b",className:"text-red-600",children:"A plan already exists."}));return}const x=[...s,c];G(x),o(P=>({...P,payPerShipmentGroup:{...P==null?void 0:P.payPerShipmentGroup,sellingPlansToCreate:x}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan added successfully!"}))}k(),y(!1)};t.useEffect(()=>{I||o(i=>({...i,payPerShipmentGroup:{groupName:v.groupName,sellingPlansToCreate:s}}))},[v,s,o]),t.useEffect(()=>{const i=JSON.stringify(c)!==JSON.stringify(M);g(i)},[c]);const k=()=>{d(M),f(null),g(!1)},y=q(C,50,w),S={onEdit:i=>{d(s[i]),f(i),y(!0)},onDelete:i=>m(i),onDuplicate:i=>{d({...s[i],frequencyName:`${s[i].frequencyName}`}),f(null),y(!0)}};return t.useEffect(()=>{n?setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},100):window.scrollTo({top:0,behavior:"smooth"})},[n]),e.jsxs("div",{className:"rounded-[10px] p-3 relative",children:[e.jsxs("div",{className:`flex flex-col gap-4 ${N?"opacity-50 pointer-events-none":""}`,children:[N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})}),e.jsx("div",{children:(s.length||n)&&e.jsx(ie,{currentGroup:v,onChange:(i,x)=>r(P=>({...P,[i]:x}))})}),e.jsx("div",{className:"flex flex-col gap-4",children:s.map((i,x)=>e.jsx(ae,{plan:i,index:x,actions:S},x))}),e.jsx("div",{className:"flex",children:e.jsx(A.Button,{variant:"text",onClick:()=>y(!0),className:"text-blue-600 cursor-pointer hover:underline text-sm",children:"Add another plan"})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:H,className:"border border-muted rounded-[10px] p-3",children:e.jsx(te,{plan:c,onChange:d})}),e.jsxs("div",{className:"flex gap-4 mt-5",children:[e.jsxs(A.Button,{onClick:U,children:["Done",N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})})]}),b&&e.jsx(A.Button,{variant:"outline",onClick:()=>j(!0),children:"Cancel"})]})]})]}),e.jsx(z,{isOpen:p!==null,title:"Delete Plan",message:`Delete plan "${p!==null?s[p].planName:""}"?`,onConfirm:()=>{G(s.filter((i,x)=>x!==p)),m(null)},onCancel:()=>m(null)}),e.jsx(z,{isOpen:h,title:"Discard Changes",message:"Are you sure you want to discard changes?",onConfirm:k,onCancel:()=>j(!1)})]})},Ye=()=>{const[s,l]=R(de),[a,o]=R(Y),[u,f]=t.useState(null),[p,m]=t.useState(null),[c,d]=t.useState(M),[v,r]=t.useState(ne),[h,j]=t.useState(!1),[b,g]=t.useState(!1),[n,C]=t.useState(!1),[N,w]=t.useState(!1),[$]=_(),I=$.get("plansUpdate")==="yes",H=t.useRef(null),G=q(l,50,w);t.useEffect(()=>{console.log("createPlanPageState",a),I&&(a!=null&&a.prePaidSubscriptionsGroup)&&(r({groupName:a.prePaidSubscriptionsGroup.groupName,sellingPlansToUpdate:a.prePaidSubscriptionsGroup.sellingPlansToUpdate,descriptionContent:a.prePaidSubscriptionsGroup.descriptionContent,sellingPlansToCreate:[]}),a.prePaidSubscriptionsGroup.sellingPlansToUpdate&&l(a.prePaidSubscriptionsGroup.sellingPlansToUpdate))},[I,a==null?void 0:a.prePaidSubscriptionsGroup]);const U=()=>{if(u!==null){const i=[...s];i[u]=c,G(i),o(x=>({...x,prePaidSubscriptionsGroup:{...x==null?void 0:x.prePaidSubscriptionsGroup,sellingPlansToUpdate:i}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan updated"}))}else{if(s.some(P=>P.orderFrequency===c.billingRecurringPolicyIntervalCount&&P.frequencyUnit===c.billingRecurringPolicyInterval)){T.error(e.jsx(E.Text,{as:"b",className:"text-red-600",children:"A plan already exists."}));return}const x=[...s,c];G(x),o(P=>({...P,prePaidSubscriptionsGroup:{...P==null?void 0:P.prePaidSubscriptionsGroup,sellingPlansToCreate:x}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan added successfully!"}))}k(),y(!1)};t.useEffect(()=>{I||o(i=>({...i,prePaidSubscriptionsGroup:{groupName:v.groupName,sellingPlansToCreate:s}}))},[v,s,o]),t.useEffect(()=>{const i=JSON.stringify(c)!==JSON.stringify(M);g(i)},[c]);const k=()=>{d(M),f(null),g(!1)},y=q(C,50,w),S={onEdit:i=>{d(s[i]),f(i),y(!0)},onDelete:i=>m(i),onDuplicate:i=>{d({...s[i],frequencyName:`${s[i].frequencyName}`}),f(null),y(!0)}};return t.useEffect(()=>{n?setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},100):window.scrollTo({top:0,behavior:"smooth"})},[n]),e.jsxs("div",{className:"rounded-[10px] p-3 relative",children:[e.jsxs("div",{className:`flex flex-col gap-4 ${N?"opacity-50 pointer-events-none":""}`,children:[N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})}),e.jsx("div",{children:(s.length||n)&&e.jsx(ie,{currentGroup:v,onChange:(i,x)=>r(P=>({...P,[i]:x}))})}),e.jsx("div",{className:"flex flex-col gap-4",children:s.map((i,x)=>e.jsx(ae,{plan:i,index:x,actions:S},x))}),e.jsx("div",{className:"flex",children:e.jsx(A.Button,{variant:"text",onClick:()=>y(!0),className:"text-blue-600 cursor-pointer hover:underline text-sm",children:"Add another plan"})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:H,className:"border border-muted rounded-[10px] p-3",children:e.jsx(te,{plan:c,onChange:d,prePaidFrom:!0})}),e.jsxs("div",{className:"flex gap-4 mt-5",children:[e.jsxs(A.Button,{onClick:U,children:["Done",N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})})]}),b&&e.jsx(A.Button,{variant:"outline",onClick:()=>j(!0),children:"Cancel"})]})]})]}),e.jsx(z,{isOpen:p!==null,title:"Delete Plan",message:`Delete plan "${p!==null?s[p].planName:""}"?`,onConfirm:()=>{G(s.filter((i,x)=>x!==p)),m(null)},onCancel:()=>m(null)}),e.jsx(z,{isOpen:h,title:"Discard Changes",message:"Are you sure you want to discard changes?",onConfirm:k,onCancel:()=>j(!1)})]})},Je=()=>{const[s,l]=t.useState(J),[a,o]=t.useState(!1),[u,f]=t.useState(!1),[p,m]=t.useState(!1),[c]=R(oe),[d,v]=R(Y);t.useEffect(()=>{c&&(J.planName=c.title)},[c]);const r=t.useCallback((n,C)=>{l(N=>({...N,[n]:C})),m(!0)},[]),h=async()=>{f(!0);try{T.success("One-time plan saved successfully!"),o(!0),m(!1),v(n=>({...n,oneTimeGroup:{groupName:s.planName,sellingPlansToCreate:[s]}}))}finally{f(!1)}},j=t.useCallback(n=>{o(n),m(n)},[]),b=t.useCallback(()=>{m(!0)},[]),g=t.useCallback(()=>{o(!1),m(!1),l(J),T.success("Plan deleted successfully!")},[]);return t.useEffect(()=>{p&&setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},100)},[p]),e.jsxs("div",{className:"border border-muted rounded-[10px] p-3 relative",children:[u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})}),e.jsx(Pe,{isPlanEnabled:a,onToggle:j}),a&&(p?e.jsx(xe,{currentPlan:s,onChange:r,onSave:h,productTitle:(c==null?void 0:c.title)||""}):e.jsx("div",{className:"mt-6",children:e.jsx(ve,{plan:s,index:0,actions:{onEdit:b,onDelete:g,onDuplicate:()=>{}}})}))]})},We=()=>{const[s,l]=R(Ce),[a,o]=R(Y),[u,f]=t.useState(null),[p,m]=t.useState(null),[c,d]=t.useState(M),[v,r]=t.useState(ne),[h,j]=t.useState(!1),[b,g]=t.useState(!1),[n,C]=t.useState(!1),[N,w]=t.useState(!1),$=t.useRef(null),I=q(l,50,w),H=()=>{if(u!==null){const y=[...s];y[u]=c,I(y),o(S=>({...S,payPerShipmentGroup:{...S==null?void 0:S.payPerShipmentGroup,sellingPlansToUpdate:y}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan updated"}))}else{if(s.some(i=>i.orderFrequency===c.billingRecurringPolicyIntervalCount&&i.frequencyUnit===c.billingRecurringPolicyInterval)){T.error(e.jsx(E.Text,{as:"b",className:"text-red-600",children:"A plan already exists."}));return}const S=[...s,c];I(S),o(i=>({...i,payPerShipmentGroup:{...i==null?void 0:i.payPerShipmentGroup,sellingPlansToCreate:S}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan added successfully!"}))}G(),U(!1)};t.useEffect(()=>{o(y=>({...y,payPerShipmentGroup:{groupName:v.groupName,sellingPlansToCreate:s}}))},[v,s,o]),t.useEffect(()=>{const y=JSON.stringify(c)!==JSON.stringify(M);g(y)},[c]);const G=()=>{d(M),f(null),g(!1)},U=q(C,50,w),k={onEdit:y=>{d(s[y]),f(y),U(!0)},onDelete:y=>m(y),onDuplicate:y=>{d({...s[y],frequencyName:`${s[y].frequencyName}`}),f(null),U(!0)}};return t.useEffect(()=>{n?setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},100):window.scrollTo({top:0,behavior:"smooth"})},[n]),e.jsxs("div",{className:"rounded-[10px] p-3 relative",children:[e.jsxs("div",{className:`flex flex-col gap-4 ${N?"opacity-50 pointer-events-none":""}`,children:[N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})}),e.jsx("div",{children:(s.length||n)&&e.jsx(ie,{currentGroup:v,onChange:(y,S)=>r(i=>({...i,[y]:S}))})}),s.length>0&&e.jsx("div",{className:"flex flex-col gap-4",children:s.map((y,S)=>e.jsx(ae,{plan:y,index:S,actions:k},S))}),e.jsx("div",{className:"flex",children:e.jsx(A.Button,{variant:"text",onClick:()=>U(!0),className:"text-blue-600 cursor-pointer hover:underline text-sm",children:"Add another plan"})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:$,className:"border border-muted rounded-[10px] p-3",children:e.jsx(te,{plan:c,onChange:d})}),e.jsxs("div",{className:"flex gap-4 mt-5",children:[e.jsxs(A.Button,{onClick:H,children:["Done",N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})})]}),b&&e.jsx(A.Button,{variant:"outline",onClick:()=>j(!0),children:"Cancel"})]})]})]}),e.jsx(z,{isOpen:p!==null,title:"Delete Plan",message:`Delete plan "${p!==null?s[p].planName:""}"?`,onConfirm:()=>{I(s.filter((y,S)=>S!==p)),m(null)},onCancel:()=>m(null)}),e.jsx(z,{isOpen:h,title:"Discard Changes",message:"Are you sure you want to discard changes?",onConfirm:G,onCancel:()=>j(!1)})]})},_e=()=>{const[s,l]=R(de),[a,o]=R(Y),[u,f]=t.useState(null),[p,m]=t.useState(null),[c,d]=t.useState(re),[v,r]=t.useState(ne),[h,j]=t.useState(!1),[b,g]=t.useState(!1),[n,C]=t.useState(!1),[N,w]=t.useState(!1),[$]=_(),I=$.get("plansUpdate")==="yes",H=t.useRef(null),G=q(l,50,w);t.useEffect(()=>{console.log("createPlanPageState",a),I&&(a!=null&&a.prePaidSubscriptionsGroup)&&(r({groupName:a.prePaidSubscriptionsGroup.groupName,sellingPlansToUpdate:a.prePaidSubscriptionsGroup.sellingPlansToUpdate,descriptionContent:a.prePaidSubscriptionsGroup.descriptionContent,sellingPlansToCreate:[]}),a.prePaidSubscriptionsGroup.sellingPlansToUpdate&&l(a.prePaidSubscriptionsGroup.sellingPlansToUpdate))},[I,a==null?void 0:a.prePaidSubscriptionsGroup]);const U=()=>{if(u!==null){const i=[...s];i[u]=c,G(i),o(x=>({...x,prePaidSubscriptionsGroup:{...x==null?void 0:x.prePaidSubscriptionsGroup,sellingPlansToUpdate:i}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan updated"}))}else{if(s.some(P=>P.orderFrequency===c.billingRecurringPolicyIntervalCount&&P.frequencyUnit===c.billingRecurringPolicyInterval)){T.error(e.jsx(E.Text,{as:"b",className:"text-red-600",children:"A plan already exists."}));return}const x=[...s,c];G(x),o(P=>({...P,prePaidSubscriptionsGroup:{...P==null?void 0:P.prePaidSubscriptionsGroup,sellingPlansToCreate:x}})),T.success(e.jsx(E.Text,{as:"b",children:"Plan added successfully!"}))}k(),y(!1)};t.useEffect(()=>{I||o(i=>({...i,prePaidSubscriptionsGroup:{groupName:v.groupName,sellingPlansToCreate:s}}))},[v,s,o]),t.useEffect(()=>{const i=JSON.stringify(c)!==JSON.stringify(re);g(i)},[c]);const k=()=>{d(re),f(null),g(!1)},y=q(C,50,w),S={onEdit:i=>{d(s[i]),f(i),y(!0)},onDelete:i=>m(i),onDuplicate:i=>{d({...s[i],frequencyName:`${s[i].frequencyName}`}),f(null),y(!0)}};return t.useEffect(()=>{n?setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},100):window.scrollTo({top:0,behavior:"smooth"})},[n]),e.jsxs("div",{className:"rounded-[10px] p-3 relative",children:[e.jsxs("div",{className:`flex flex-col gap-4 ${N?"opacity-50 pointer-events-none":""}`,children:[N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})}),e.jsx("div",{children:(s.length||n)&&e.jsx(ie,{currentGroup:v,onChange:(i,x)=>r(P=>({...P,[i]:x}))})}),e.jsx("div",{className:"flex flex-col gap-4",children:s.map((i,x)=>e.jsx(ae,{plan:i,index:x,actions:S},x))}),e.jsx("div",{className:"flex",children:e.jsx(A.Button,{variant:"text",onClick:()=>y(!0),className:"text-blue-600 cursor-pointer hover:underline text-sm",children:"Add another plan"})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:H,className:"border border-muted rounded-[10px] p-3",children:e.jsx(te,{plan:c,onChange:d,prePaidFrom:!0})}),e.jsxs("div",{className:"flex gap-4 mt-5",children:[e.jsxs(A.Button,{onClick:U,children:["Done",N&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(O.Loader,{variant:"spinner"})})]}),b&&e.jsx(A.Button,{variant:"outline",onClick:()=>j(!0),children:"Cancel"})]})]})]}),e.jsx(z,{isOpen:p!==null,title:"Delete Plan",message:`Delete plan "${p!==null?s[p].planName:""}"?`,onConfirm:()=>{G(s.filter((i,x)=>x!==p)),m(null)},onCancel:()=>m(null)}),e.jsx(z,{isOpen:h,title:"Discard Changes",message:"Are you sure you want to discard changes?",onConfirm:k,onCancel:()=>j(!1)})]})};function Ke({handleSavePlans:s,createPlanLoader:l}){const[a]=_(),o=a.get("plansUpdate")==="yes";return e.jsx("div",{className:"container",children:e.jsxs("div",{className:"grid grid-cols-[80%_15%] gap-4 mt-4 relative",children:[e.jsx("div",{children:e.jsx("div",{className:"grid col-span-full gap-4 2xl:grid-cols-2 4xl:col-span-8 4xl:gap-5 xl:gap-7 xyz",children:e.jsxs(F.Tab,{children:[e.jsxs(F.Tab.List,{children:[e.jsx(F.Tab.ListItem,{children:"Onetime Settings"}),e.jsx(F.Tab.ListItem,{children:e.jsxs(Ae.Flex,{align:"center",children:[e.jsx(ue,{}),e.jsx(E.Title,{as:"h3",className:"text-sm",children:"Pay Per Shipment"})]})}),e.jsx(F.Tab.ListItem,{children:"Prepaid Subscriptions"})]}),e.jsxs(F.Tab.Panels,{children:[e.jsx(F.Tab.Panel,{children:o?e.jsx(Ge,{}):e.jsx(Je,{})}),e.jsx(F.Tab.Panel,{children:o?e.jsx(Ve,{}):e.jsx(We,{})}),e.jsx(F.Tab.Panel,{children:o?e.jsx(Ye,{}):e.jsx(_e,{})})]})]})})}),e.jsx("div",{className:"p-3 border border-muted rounded-[10px] sticky top-0 right-0 h-full w-full",children:e.jsx("div",{className:"flex",children:e.jsx(A.Button,{className:"ml-auto",isLoading:l,onClick:()=>s(),children:o?"Update Plan":"Save Changes"})})})]})})}const ps=()=>{const s=Ne(),l=Ie(),{productId:a}=Re(),[o]=_(),u=o.get("plansUpdate")==="yes",[f,p]=t.useState(!1),[m]=R(Y),[c]=R(oe);t.useEffect(()=>{if(!l.data)return;p(!1);const r=l.data;if("error"in r){T.error(r.error);return}let h=[],j=[];Object.entries(r).forEach(([b,g])=>{const n=Xe(b);g!=null&&g.success?h.push(`${n} created successfully!`):g!=null&&g.errors&&g.errors.forEach(C=>{j.push(`${n}: ${C}`)})}),j.length>0?T.error(j.join(`
`)):h.length>0&&(T.success(h.join(`
`)),window.history.back())},[l.data]);const d=r=>{const h={...r};return Object.keys(h).forEach(j=>{const b=h[j];if(!b||!b.sellingPlansToCreate&&!b.sellingPlansToUpdate)return;const g=b.sellingPlansToCreate||[],n=b.sellingPlansToUpdate||[],C=g.filter(w=>w==null?void 0:w.id),N=g.filter(w=>!(w!=null&&w.id));h[j]={...b,sellingPlansToCreate:N,sellingPlansToUpdate:[...n,...C]}}),h},v=()=>{var j;if(!((j=c==null?void 0:c.currentAppInstallation)!=null&&j.app)){T.error("Missing required product information");return}const r=u?m:d(m);p(!0);const h=new FormData;h.append("plans",JSON.stringify(r)),h.append("productId",a),h.append("appId",c.currentAppInstallation.app.id),u&&h.append("plansUpdate","yes"),l.submit(h,{method:"POST",action:".",encType:"multipart/form-data"})};return s?c?e.jsx("div",{className:"position-relative",children:e.jsx(Ke,{handleSavePlans:v,createPlanLoader:f})}):e.jsxs("div",{className:"flex justify-center items-center h-screen flex-col",children:[e.jsx(O.Loader,{variant:"spinner",className:"h-8 w-8"}),e.jsx("span",{className:"ml-2",children:"Need to load data here..."})]}):null};function Xe(s){return s.replace(/([A-Z])/g," $1").replace(/^./,l=>l.toUpperCase()).replace(" Group","")}export{ps as default};
//# sourceMappingURL=merchant.products_._productId_.plans-ByX8wZZm.js.map
