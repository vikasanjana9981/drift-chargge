import{j as s,r as C}from"./index-DngLVFUg.js";import{e as j,u as _}from"./shopifyIdUtils-PhKRAdsZ.js";import{r as R}from"./routes-C5ziuI-K.js";import{P as $}from"./sortable.esm-BtEANffx.js";import{c as q,u as Q,M as W}from"./index-S_-kqkM7.js";import{u as J,F as K,T as X,S as B,a as Z,b as ee,c as se}from"./use-debounce-DebNFhLb.js";import{c as p,P as ae,a as te,b as re,d as le}from"./index-D2lKkHqc.js";import{d as l}from"./index-BflDdoZd.js";import{d as ne}from"./dayjs.min-CiIypPr9.js";import{m as y}from"./messages-BV2XNudo.js";import{o as V,p as ie,L as ce,u as oe}from"./components-DCDtNDXQ.js";import{g as I}from"./sellingPlansGroupUtils-DNlCIa3o.js";function w(e){return e.replace(/[_-]/g," ")}const c={success:["text-green-dark","bg-green-dark"],warning:["text-orange-dark","bg-orange-dark"],danger:["text-red-dark","bg-red-dark"],default:["text-gray-600","bg-gray-600"]},E={online:c.success,offline:c.default,pending:c.warning,paid:c.success,overdue:c.danger,completed:c.success,cancelled:c.danger,publish:c.success,unpublished:c.danger,approved:c.success,rejected:c.danger,active:c.success,deactivated:c.danger,on_going:c.warning,at_risk:c.danger,delayed:c.default,draft:c.default,refunded:c.default};function de(e){const a=e.toLowerCase();return a in E?s.jsxs(l.Flex,{align:"center",gap:"2",className:"w-auto",children:[s.jsx(l.Badge,{renderAsDot:!0,className:E[a][1]}),s.jsx(l.Text,{className:p("font-medium capitalize",E[a][0]),children:w(a)})]}):s.jsxs(l.Flex,{align:"center",gap:"2",className:"w-auto",children:[s.jsx(l.Badge,{renderAsDot:!0,className:"bg-gray-600"}),s.jsx(l.Text,{className:"font-medium capitalize text-gray-600",children:w(a)})]})}function ue({src:e,name:a,className:n,description:t,avatarProps:i,nameClassName:r}){return s.jsxs("figure",{className:p("flex items-center gap-3",n),children:[s.jsx(l.Avatar,{name:a,src:e,...i}),s.jsxs("figcaption",{className:"grid gap-0.5",children:[s.jsx(l.Text,{className:p("font-lexend text-sm font-medium text-gray-900 dark:text-gray-700",r),children:a}),t&&s.jsx(l.Text,{className:"text-[13px] text-gray-500",children:t})]})]})}const z={subscription:["text-blue-600","bg-blue-600"],onetime:["text-gray-600","bg-gray-600"]};function pe(e){const{oneTime:a,subscriptions:n}=e;return!a&&!n?null:s.jsxs(l.Flex,{direction:n&&a?"col":"row",justify:"center",align:"center",gap:"2",className:"w-auto",children:[n&&s.jsx(l.Badge,{className:p("px-2 py-1 text-white",z.subscription[1]),children:w("Subscription")}),a&&s.jsx(l.Badge,{className:p("px-2 py-1 text-white",z.onetime[1]),children:w("One-Time")})]})}function S(e,a="DD MMM, YYYY"){return e?ne(e).format(a):""}function ge({date:e,className:a,timeClassName:n,dateClassName:t,dateFormat:i="MMMM D, YYYY",timeFormat:r="h:mm A"}){return s.jsxs("div",{className:p("grid gap-1",a),children:[s.jsx("time",{dateTime:S(e,"YYYY-MM-DD"),className:p("font-medium text-gray-700",t),children:S(e,i)}),s.jsx("time",{dateTime:S(e,"HH:mm:ss"),className:p("text-[13px] text-gray-500",n),children:S(e,r)})]})}const f=q(),me=[f.display({id:"select",size:50,header:({table:e})=>s.jsx(l.Checkbox,{className:"ps-3.5","aria-label":"Select all rows",checked:e.getIsAllPageRowsSelected(),onChange:()=>e.toggleAllPageRowsSelected()}),cell:({row:e})=>s.jsx(l.Checkbox,{className:"ps-3.5","aria-label":"Select row",checked:e.getIsSelected(),onChange:()=>e.toggleSelected()})}),f.display({id:"product",size:300,header:"Product",cell:({row:e})=>s.jsx(ue,{src:e.original.image.url||"",name:e.original.title,description:`${e.original.variantsCount} variants`,avatarProps:{name:e.original.title,size:"lg",className:"rounded-lg"}})}),f.display({id:"status",size:150,header:"Shopify status",enableSorting:!1,cell:({row:e})=>s.jsx("div",{children:s.jsxs("div",{children:[s.jsx("span",{children:"Product"}),s.jsx("span",{children:de(e.original.status)})]})})}),f.display({id:"purchase_type",size:150,header:"Purchase types",cell:({row:e})=>{const{purchaseType:a}=e.original;return pe(a)}}),f.display({id:"frquencies",size:150,header:"Selling Plans ",cell:({row:e})=>s.jsx(l.Text,{className:"text-sm",children:e.original.sellingPlanGroupsCount})}),f.display({id:"createdAt",size:150,header:"Created At",cell:({row:e})=>s.jsx(ge,{date:new Date(e.original.createdAt)})})];var P=(e=>(e.ACTIVE="ACTIVE",e.ARCHIVED="ARCHIVED",e.DRAFT="DRAFT",e))(P||{}),H=(e=>(e.APPROVED="approved",e.REJECTED="rejected",e.NEEDS_ACTION="needs_action",e.AWAITING_REVIEW="awaiting_review",e.PUBLISHED="published",e.DEMOTED="demoted",e.SCHEDULED="scheduled",e.PROVISIONALLY_PUBLISHED="provisionally_published",e))(H||{});const he={approved:"Approved",rejected:"Rejected",needs_action:"Needs Action",awaiting_review:"Awaiting Review",published:"Published",demoted:"Demoted",scheduled:"Scheduled",provisionally_published:"Provisionally Published"};Object.values(H).map(e=>({value:e,label:he[e]}));const v={ACTIVE:"Active",ARCHIVED:"Archived",DRAFT:"Draft"},xe=Object.values(P).map(e=>({value:e,label:v[e]}));var T=(e=>(e.PUBLISHED="published",e.UNPUBLISHED="unpublished",e))(T||{});const F={published:"Published",unpublished:"Unpublished"},fe=Object.values(T).map(e=>({value:e,label:F[e]}));function je({table:e,filtersHanlder:a}){const[n,t]=C.useState(!1),i=e.getSelectedRowModel().rows.length>1,{handleQuerySearch:r,handleStatusChange:o,handlePublishedStatusChange:d}=a,[u,h]=V(),[m,g]=C.useState(u.get("query")??""),x=J(m,300);C.useEffect(()=>{r(x)},[x]);const A=()=>{e.resetGlobalFilter(),e.resetColumnFilters(),g(""),r(""),o(null),d(""),h({})};return s.jsxs(l.Flex,{align:"center",justify:"between",className:"mb-4",children:[s.jsx(l.Input,{type:"search",placeholder:y.products.filters.search.placeholder,value:m,onClear:()=>g(""),onChange:b=>g(b.target.value),inputClassName:"h-9",clearable:!0,prefix:s.jsx(ae,{className:"size-4"})}),s.jsx(K,{isOpen:n,drawerTitle:y.products.filters.title,setOpenDrawer:t,children:s.jsx("div",{className:"grid grid-cols-1 gap-6",children:s.jsx(be,{table:e,filtersHanlder:a})})}),s.jsxs(l.Flex,{align:"center",gap:"3",className:"w-auto",children:[i?s.jsxs(l.Button,{color:"danger",variant:"outline",className:"h-[34px] gap-2 text-sm",onClick:()=>{},children:[s.jsx(te,{size:18}),"Delete"]}):null,s.jsxs(l.Button,{variant:"outline",onClick:()=>t(!n),className:"h-9 pe-3 ps-2.5",children:[s.jsx(re,{className:"me-1.5 size-[18px]",strokeWidth:1.7}),"Filters"]}),s.jsxs(l.Button,{variant:"flat",className:"h-9 bg-gray-200/70",onClick:A,children:[s.jsx(le,{className:"me-1.5 h-[17px] w-[17px]"})," Clear Filters"]}),s.jsx(X,{table:e})]})]})}function be({table:e,filtersHanlder:a}){const{handleStatusChange:n,handlePublishedStatusChange:t}=a,[i]=V();return s.jsxs(s.Fragment,{children:[s.jsx(B,{options:xe,value:i.get("status"),onChange:r=>{n(r)},getOptionValue:r=>r.value,getOptionDisplayValue:r=>L(r.value),displayValue:r=>L(r),dropdownClassName:"!z-20 h-auto top-15",className:"w-auto",label:`${y.products.filters.status.title}`}),s.jsx(B,{options:fe,value:i.get("onlineStoreStatus"),onChange:r=>{t(r)},getOptionValue:r=>r.value,getOptionDisplayValue:r=>M(r.value),displayValue:r=>M(r),dropdownClassName:"!z-20 h-auto top-15",className:"w-auto",label:`${y.products.filters.publishedStatus.title}`})]})}function M(e){switch(e){case T.PUBLISHED:return s.jsxs("div",{className:"flex items-center",children:[s.jsx(l.Badge,{color:"success",renderAsDot:!0}),s.jsx(l.Text,{className:"ms-2 font-medium capitalize text-green-dark",children:F[e]})]});case T.UNPUBLISHED:return s.jsxs("div",{className:"flex items-center",children:[s.jsx(l.Badge,{color:"danger",renderAsDot:!0}),s.jsx(l.Text,{className:"ms-2 font-medium capitalize text-red-dark",children:F[e]})]})}}function L(e){switch(e){case P.ACTIVE:return s.jsxs("div",{className:"flex items-center",children:[s.jsx(l.Badge,{color:"success",renderAsDot:!0}),s.jsx(l.Text,{className:"ms-2 font-medium capitalize text-green-dark",children:v[e]})]});case P.ARCHIVED:return s.jsxs("div",{className:"flex items-center",children:[s.jsx(l.Badge,{color:"warning",renderAsDot:!0}),s.jsx(l.Text,{className:"ms-2 font-medium capitalize text-orange-dark",children:v[e]})]});case P.DRAFT:return s.jsxs("div",{className:"flex items-center",children:[s.jsx(l.Badge,{color:"danger",renderAsDot:!0}),s.jsx(l.Text,{className:"ms-2 font-medium capitalize text-red-dark",children:v[e]})]})}}function Ne({pageSize:e,hideFilters:a=!1,hidePagination:n=!1,hideFooter:t=!1,classNames:i={container:"border border-muted rounded-md",rowClassName:"last:border-0 cursor-pointer"},paginationClassName:r,responseData:o}){const{handlePageSizeChange:d,handlePageChange:u,handleStatusChange:h,handlePublishedStatusChange:m,handleQuerySearch:g}=Z(),x=ie(),{response:{products:{pageInfo:A}}}=o,b=C.useMemo(()=>o?Ce(o,x):[],[o]),{table:N,setData:k}=Q({tableData:b,columnConfig:me,options:{initialState:{pagination:{pageIndex:0,pageSize:e}},enableColumnResizing:!1}});N.getSelectedRowModel().rows.map(D=>D.original);function G(){console.log("handleExportData products table")}const U={handleStatusChange:h,handleQuerySearch:g,handlePublishedStatusChange:m};return C.useEffect(()=>{k(b)},[b,k]),s.jsxs(s.Fragment,{children:[!a&&s.jsx(je,{table:N,filtersHanlder:U}),s.jsx(W,{table:N,variant:"modern",classNames:i}),!t&&s.jsx(ee,{table:N,onExport:G}),!n&&s.jsx(se,{table:N,className:p("py-4",r),onPageSizeChange:d,pageInfo:A,onPageChange:(D,Y)=>u(D,Y)})]})}const Ce=(e,a)=>{const{response:{products:n}}=e;return n.edges.map(({node:t})=>{var i,r,o,d,u;return{id:t.id,title:t.title,handle:t.handle,createdAt:t.createdAt,requiresSellingPlan:t.requiresSellingPlan,status:t.status,image:{url:(o=(r=(i=t.featuredMedia)==null?void 0:i.preview)==null?void 0:r.image)==null?void 0:o.url,alt:(d=t.featuredMedia)==null?void 0:d.alt},variantsCount:(u=t==null?void 0:t.variantsCount)==null?void 0:u.count,onlineStorePreviewUrl:t==null?void 0:t.onlineStorePreviewUrl,numericId:j(t.id),purchaseType:Se(t,e),sellingPlanGroupsCount:Pe(t,e),onRowClick:()=>a(`/merchant/products/${j(t.id)}`)}})},Pe=(e,a)=>{var r,o,d;const n=((d=(o=(r=a==null?void 0:a.response)==null?void 0:r.currentAppInstallation)==null?void 0:o.app)==null?void 0:d.id)||"",t=j(n);return e.sellingPlanGroups.edges.filter(u=>j(u.node.appId)===t).length},Se=(e,a)=>{var d,u,h,m,g;if(!((u=(d=e==null?void 0:e.sellingPlanGroups)==null?void 0:d.edges)!=null&&u.length))return{oneTime:!1,subscriptions:!1};const n=((g=(m=(h=a==null?void 0:a.response)==null?void 0:h.currentAppInstallation)==null?void 0:m.app)==null?void 0:g.id)||"",t=j(n),i=e.sellingPlanGroups.edges.filter(x=>j(x.node.appId)===t),r=!!I(i,"Onetime Plan Group"),o=!!I(i,"PayPerShipment Plan Group")||!!I(i,"PrePaid Plan Group");return{oneTime:r,subscriptions:o}},O={title:"Products",breadcrumb:[{href:R.products.products,name:"Products"},{name:"List"}]};function ve({responseData:e,first:a}){return s.jsxs(s.Fragment,{children:[s.jsx($,{title:O.title,breadcrumb:O.breadcrumb,children:s.jsx("div",{className:"mt-4 flex items-center gap-3 lg:mt-0",children:s.jsx(ce,{to:R.products.products,className:"w-full lg:w-auto"})})}),s.jsx(Ne,{responseData:e,pageSize:a})]})}const Le=()=>{const{apiKey:e,response:a,first:n}=oe();return _()?s.jsx(ve,{responseData:a,first:n}):null};export{Le as default};
